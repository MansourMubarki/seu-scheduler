{% extends "base.html" %}
{% block content %}
  <div class="dash-header">
    <h2>لوحة المشرف</h2>
    <div class="dash-actions">
      <form method="post" action="{{ url_for('clear_all_data') }}" onsubmit="return confirm('مسح كل البيانات؟');">
        <button class="btn btn-danger">مسح كل المحاضرات والاختبارات</button>
      </form>
    </div>
  </div>

  <section class="card">
    <h3>المستخدمون</h3>
    <div class="table-wrapper">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>الاسم</th>
            <th>البريد</th>
            <th>مشرف؟</th>
            <th>إجراءات</th>
          </tr>
        </thead>
        <tbody>
          {% for u in users %}
          <tr>
            <td>{{ u.id }}</td>
            <td>{{ u.name }}</td>
            <td>{{ u.email }}</td>
            <td>
              {% if u.is_admin %}
                <span class="badge admin">مشرف</span>
              {% else %}
                <span class="badge">مستخدم</span>
              {% endif %}
            </td>
            <td class="row-actions">
              {% if not u.is_admin %}
              <form method="post" action="{{ url_for('make_admin', uid=u.id) }}"><button class="btn btn-primary">ترقية لمشرف</button></form>
              {% else %}
              <form method="post" action="{{ url_for('remove_admin', uid=u.id) }}"><button class="btn btn-warning">إزالة مشرف</button></form>
              {% endif %}
              <form method="post" action="{{ url_for('delete_user_admin', uid=u.id) }}" onsubmit="return confirm('حذف المستخدم وكل بياناته؟');">
                <button class="btn btn-danger">حذف</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </section>
{% endblock %}